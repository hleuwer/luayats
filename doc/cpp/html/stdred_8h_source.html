<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Luayats: src/user/stdred.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>src/user/stdred.h</h1><a href="stdred_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef   _STDRED_H_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define   _STDRED_H_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;<a class="code" href="inxout_8h.html">inxout.h</a>&quot;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;<a class="code" href="queue_8h.html">queue.h</a>&quot;</span>
<a name="l00006"></a>00006 
<a name="l00008"></a>00008 <span class="comment">// class stdred</span>
<a name="l00010"></a><a class="code" href="classstdred.html">00010</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classstdred.html">stdred</a> : <span class="keyword">public</span> <a class="code" href="classinxout.html">inxout</a>
<a name="l00011"></a>00011 {
<a name="l00012"></a>00012    <span class="keyword">typedef</span>   <a class="code" href="classinxout.html">inxout</a>   <a class="code" href="classroot.html">baseclass</a>;
<a name="l00013"></a>00013 
<a name="l00014"></a>00014    <span class="keyword">public</span>:   
<a name="l00015"></a>00015 
<a name="l00016"></a><a class="code" href="classstdred.html#aa7ebfd2f149850bdaa5ad5e36c0c56bcad40ee5aabd91de3de4dbaf369f29dfae">00016</a>    <span class="keyword">enum</span> {<a class="code" href="classstdred.html#aa7ebfd2f149850bdaa5ad5e36c0c56bca4a2559d70107a28f8abe6215b79a4cc3">keyPIR</a> = 1, <a class="code" href="classstdred.html#aa7ebfd2f149850bdaa5ad5e36c0c56bcad40ee5aabd91de3de4dbaf369f29dfae">keyStatTimer</a> = 2};
<a name="l00017"></a>00017 
<a name="l00018"></a><a class="code" href="classstdred.html#a8fb09df940e42aca2a0944d4ce843c74">00018</a>    <a class="code" href="classstdred.html#a8fb09df940e42aca2a0944d4ce843c74">stdred</a>() : <a class="code" href="classstdred.html#a6cd9a907c48835200e71a945e3eb25a3">evtPIR</a>(<a class="code" href="brdec_8c.html#a50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classstdred.html#aa7ebfd2f149850bdaa5ad5e36c0c56bca4a2559d70107a28f8abe6215b79a4cc3">keyPIR</a>), <a class="code" href="classstdred.html#a9f3bb08171fb21e725e1a1ccd935b2a7">evtStatTimer</a>(<a class="code" href="brdec_8c.html#a50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classstdred.html#aa7ebfd2f149850bdaa5ad5e36c0c56bcad40ee5aabd91de3de4dbaf369f29dfae">keyStatTimer</a>)
<a name="l00019"></a>00019    {
<a name="l00020"></a>00020       <a class="code" href="classstdred.html#a5c658dc70abe94bbf609a4dd946adf6f">TimeSendNextPIR</a> = 0;
<a name="l00021"></a>00021       <a class="code" href="classstdred.html#a0bc0ab3c5d9b90d16fa67f7ef03e49cd">alarmed_late</a> = <a class="code" href="defs_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;      <span class="comment">// not alarmed</span>
<a name="l00022"></a>00022       <a class="code" href="classstdred.html#ae27f45b67f588d4f47eb14e6670e1fa8">alarmed_early</a> = <a class="code" href="defs_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00023"></a>00023       
<a name="l00024"></a>00024    }  <span class="comment">// Constructor</span>
<a name="l00025"></a>00025    
<a name="l00026"></a><a class="code" href="structstdred_1_1inpstruct.html">00026</a>    <span class="keyword">struct </span><a class="code" href="structstdred_1_1inpstruct.html">inpstruct</a>
<a name="l00027"></a>00027    {
<a name="l00028"></a><a class="code" href="structstdred_1_1inpstruct.html#aeb0ff589a2eae6e880ac38632abd678a">00028</a>       <a class="code" href="classdata.html">data</a> *<a class="code" href="structstdred_1_1inpstruct.html#aeb0ff589a2eae6e880ac38632abd678a">pdata</a>;
<a name="l00029"></a><a class="code" href="structstdred_1_1inpstruct.html#a1279360ead5546b2774ac9c4fb88fdb5">00029</a>       <span class="keywordtype">int</span> <a class="code" href="structstdred_1_1inpstruct.html#a1279360ead5546b2774ac9c4fb88fdb5">inp</a>;
<a name="l00030"></a>00030    };
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="classstdred.html#abdeccde0d1fe211ed416080b3bd28144">00032</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#abdeccde0d1fe211ed416080b3bd28144">ninp</a>;            <span class="comment">// number of inputs</span>
<a name="l00033"></a><a class="code" href="classstdred.html#a324674bc1ea96f3dfb1d90d1709d369f">00033</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a324674bc1ea96f3dfb1d90d1709d369f">max_flow</a>;        <span class="comment">// number of Flows</span>
<a name="l00034"></a><a class="code" href="classstdred.html#a7d5de060e67c4ebac04364fc02528072">00034</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a7d5de060e67c4ebac04364fc02528072">maxbuff_packet</a>;  <span class="comment">// max buffer size (packets)</span>
<a name="l00035"></a><a class="code" href="classstdred.html#a0151dde41f900d40e4ae21550b143a94">00035</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a0151dde41f900d40e4ae21550b143a94">buff_packet</a>;     <span class="comment">// buffer fill level (packets)</span>
<a name="l00036"></a><a class="code" href="classstdred.html#ae66cba4ddcb7c77f60aede3c4dabb276">00036</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#ae66cba4ddcb7c77f60aede3c4dabb276">maxbuff_byte</a>;    <span class="comment">// max buffer size (byte)</span>
<a name="l00037"></a><a class="code" href="classstdred.html#aefdfe552d37e1590bad9d776aa05f196">00037</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#aefdfe552d37e1590bad9d776aa05f196">buff_byte</a>;       <span class="comment">// buffer fill level (byte)</span>
<a name="l00038"></a><a class="code" href="classstdred.html#ae702a01a7cefccd07904d4810a7c0ab9">00038</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#ae702a01a7cefccd07904d4810a7c0ab9">slot_per_minpacket</a>;  <span class="comment">// the slots for a packet of minimum size</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classstdred.html#a6cd9a907c48835200e71a945e3eb25a3">00041</a>    <span class="keyword">event</span> <a class="code" href="classstdred.html#a6cd9a907c48835200e71a945e3eb25a3">evtPIR</a>;              <span class="comment">// Event to call the output with PCR</span>
<a name="l00042"></a><a class="code" href="classstdred.html#a9f3bb08171fb21e725e1a1ccd935b2a7">00042</a>    <span class="keyword">event</span> <a class="code" href="classstdred.html#a9f3bb08171fb21e725e1a1ccd935b2a7">evtStatTimer</a>;        <span class="comment">// Statistics Timer (for providing fairness)</span>
<a name="l00043"></a><a class="code" href="classstdred.html#a8cae075ae1708523c9c7b8a0c23fac04">00043</a>    <a class="code" href="classuqueue.html">uqueue</a> <a class="code" href="classstdred.html#a8cae075ae1708523c9c7b8a0c23fac04">q</a>;                  <span class="comment">// the queue with the packets</span>
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classstdred.html#a51a3b417cba2cc3de7618bbe911f066c">00045</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a51a3b417cba2cc3de7618bbe911f066c">use_red</a>;               <span class="comment">// determines whether RED is used or not</span>
<a name="l00046"></a>00046    
<a name="l00047"></a>00047    <span class="comment">// RED parameters</span>
<a name="l00048"></a><a class="code" href="classstdred.html#ac7cc10498817e809eb4320ff4c44b68d">00048</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#ac7cc10498817e809eb4320ff4c44b68d">red_min_th</a>;
<a name="l00049"></a><a class="code" href="classstdred.html#a8ae9033525fa591187f6a79b8d98680c">00049</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a8ae9033525fa591187f6a79b8d98680c">red_max_th</a>;  
<a name="l00050"></a><a class="code" href="classstdred.html#af47b3fb966a6dfe6156f89f22d530360">00050</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#af47b3fb966a6dfe6156f89f22d530360">red_pmax</a>;     
<a name="l00051"></a><a class="code" href="classstdred.html#a471e91fc87df45086533bd44128cbd05">00051</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a471e91fc87df45086533bd44128cbd05">red_w_q</a>;
<a name="l00052"></a>00052    
<a name="l00053"></a>00053    <span class="comment">// RED variables</span>
<a name="l00054"></a><a class="code" href="classstdred.html#aa9c472cf94b280dd340e334272b05313">00054</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#aa9c472cf94b280dd340e334272b05313">red_avg</a>;
<a name="l00055"></a><a class="code" href="classstdred.html#acfec1870bdbded0f8f4b99324fdf87cf">00055</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#acfec1870bdbded0f8f4b99324fdf87cf">red_count</a>;
<a name="l00056"></a><a class="code" href="classstdred.html#a5439943d8f82b0cd540bca1c476580ef">00056</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a5439943d8f82b0cd540bca1c476580ef">red_q_time</a>;      <span class="comment">// the time when the queue became empty</span>
<a name="l00057"></a><a class="code" href="classstdred.html#aee822fecc7e3d47ad9c43315d6c4979b">00057</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a3964e04ae68f74f3daa34ebfc74a5442">pa</a>, <a class="code" href="classstdred.html#aee822fecc7e3d47ad9c43315d6c4979b">pb</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 
<a name="l00060"></a>00060    <span class="comment">// statistics</span>
<a name="l00061"></a><a class="code" href="classstdred.html#ae80a6525577243c6d6ebc334a719a8fe">00061</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#ae80a6525577243c6d6ebc334a719a8fe">dropped_packets</a>;
<a name="l00062"></a><a class="code" href="classstdred.html#a75345fa1216833ed58f25714603520ad">00062</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a75345fa1216833ed58f25714603520ad">forced_drops</a>;
<a name="l00063"></a><a class="code" href="classstdred.html#a933f1835b2b82bd1d4f7ccdf83097ae9">00063</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a933f1835b2b82bd1d4f7ccdf83097ae9">unforced_drops</a>;
<a name="l00064"></a><a class="code" href="classstdred.html#afe13260653d3d21b89e267eab04c1ae1">00064</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#afe13260653d3d21b89e267eab04c1ae1">sent_packets</a>;
<a name="l00065"></a><a class="code" href="classstdred.html#a68f48141b19c6ef34b9207ef885cffb6">00065</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a68f48141b19c6ef34b9207ef885cffb6">sent_bytes</a>;   <span class="comment">// probably to short!</span>
<a name="l00066"></a><a class="code" href="classstdred.html#ab54a42316ddf3794d626f038d1b0a754">00066</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#ab54a42316ddf3794d626f038d1b0a754">arrived_packets</a>;
<a name="l00067"></a><a class="code" href="classstdred.html#a2495f0e19a11301731ad46b617815474">00067</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a2495f0e19a11301731ad46b617815474">throughput</a>;
<a name="l00068"></a><a class="code" href="classstdred.html#a2e3356ff67e62cc05afb6030e0c5b702">00068</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a2e3356ff67e62cc05afb6030e0c5b702">utilisation</a>;
<a name="l00069"></a>00069                   
<a name="l00070"></a><a class="code" href="classstdred.html#af48d5ca7e73f5db5e9681d8517b04328">00070</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#af48d5ca7e73f5db5e9681d8517b04328">StatTimerInterval</a>;        <span class="comment">// length of Timer-Interval in slots</span>
<a name="l00071"></a><a class="code" href="classstdred.html#ad18c0615b92118d4ef812c3ee87fd155">00071</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#ad18c0615b92118d4ef812c3ee87fd155">TimerIntervalSeconds</a>;  <span class="comment">// Timer interval in seconds</span>
<a name="l00072"></a>00072    
<a name="l00073"></a><a class="code" href="classstdred.html#a0bc0ab3c5d9b90d16fa67f7ef03e49cd">00073</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a0bc0ab3c5d9b90d16fa67f7ef03e49cd">alarmed_late</a>;          <span class="comment">// alarmed for late phase?</span>
<a name="l00074"></a><a class="code" href="classstdred.html#ae27f45b67f588d4f47eb14e6670e1fa8">00074</a>    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#ae27f45b67f588d4f47eb14e6670e1fa8">alarmed_early</a>;         <span class="comment">// alarmed for elary phase?</span>
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="classstdred.html#a5c658dc70abe94bbf609a4dd946adf6f">00076</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a5c658dc70abe94bbf609a4dd946adf6f">TimeSendNextPIR</a>;    <span class="comment">// when to send the next packet according to PIR</span>
<a name="l00077"></a><a class="code" href="classstdred.html#a7e3407e655df417bec0a1f993a2dc4b2">00077</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a7e3407e655df417bec0a1f993a2dc4b2">SlotLength</a>;         <span class="comment">// Length of 1 Slot in seconds</span>
<a name="l00078"></a><a class="code" href="classstdred.html#a9392604e9ad7a1f69628001755e58a68">00078</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a9392604e9ad7a1f69628001755e58a68">PIR</a>;                <span class="comment">// PIR of the connection (bit/s)</span>
<a name="l00079"></a><a class="code" href="classstdred.html#a56b2599334786a36f0969646bdad3e84">00079</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a56b2599334786a36f0969646bdad3e84">actual_rate</a>;        <span class="comment">// the actual rate</span>
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="classstdred.html#ae69c8b9c801660208c814ca86d7f245dab0ae2e3a71ed3c2a69f692973e916883">00081</a>    <span class="keyword">enum</span> {<a class="code" href="classstdred.html#ae69c8b9c801660208c814ca86d7f245dab0ae2e3a71ed3c2a69f692973e916883">SucData</a> = 0};
<a name="l00082"></a><a class="code" href="classstdred.html#a84d2fcdfa0470f2e5cb6b092a8cbad1d">00082</a>    <a class="code" href="structstdred_1_1inpstruct.html">inpstruct</a> *<a class="code" href="classstdred.html#a84d2fcdfa0470f2e5cb6b092a8cbad1d">inp_buff</a>;    <span class="comment">// buffer for cells arriving in the early slot phase</span>
<a name="l00083"></a><a class="code" href="classstdred.html#a7d2002276d4d95bbedaa2d732b9b72f2">00083</a>    <a class="code" href="structstdred_1_1inpstruct.html">inpstruct</a> *<a class="code" href="classstdred.html#a7d2002276d4d95bbedaa2d732b9b72f2">inp_ptr</a>;     <span class="comment">//current position in inp_buff</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085    <span class="comment">// Methods</span>
<a name="l00086"></a>00086    <span class="keywordtype">void</span> <a class="code" href="classstdred.html#a193adca2fc515500cfc6892a1d99e39f">init</a>(<span class="keywordtype">void</span>);
<a name="l00087"></a>00087    <a class="code" href="special_8h.html#ab864a03586cda9a5eb915b54be9b7403">rec_typ</a> <a class="code" href="classstdred.html#afc76c2815f8aff0f67d03db2735363f5">REC</a>(<a class="code" href="classdata.html">data</a>*,<span class="keywordtype">int</span>);
<a name="l00088"></a>00088    <span class="keywordtype">void</span> <a class="code" href="classstdred.html#ac53e2ceac44dc22231d89e639b394ae3">late</a>(<a class="code" href="classevent.html">event</a>*);
<a name="l00089"></a>00089    <span class="keywordtype">void</span> <a class="code" href="classstdred.html#a95bf598486f4bdabe90a47c6837f11e7">early</a>(<a class="code" href="classevent.html">event</a> *);
<a name="l00090"></a>00090    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a3170bc592d90240288b55507ba994aea">export</a>(<a class="code" href="structexp__typ.html">exp_typ</a> *);
<a name="l00091"></a>00091    <span class="keywordtype">int</span> <a class="code" href="classstdred.html#afcb59f8042ebdf547805abcb5bf7681d">command</a>(<span class="keywordtype">char</span> *,<a class="code" href="struct__t__t__.html">tok_typ</a> *);
<a name="l00092"></a>00092    <span class="keywordtype">void</span> <a class="code" href="classstdred.html#a51356bf881e2a33f8f31338f74d055c8">connect</a>(<span class="keywordtype">void</span>);
<a name="l00093"></a><a class="code" href="classstdred.html#a2cdb319146d589f7cf4a97bce7e13f1f">00093</a>    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classstdred.html#a2cdb319146d589f7cf4a97bce7e13f1f">SlotToTime</a>(<span class="keywordtype">int</span> t){<span class="keywordflow">return</span> t*<a class="code" href="classstdred.html#a7e3407e655df417bec0a1f993a2dc4b2">SlotLength</a>;};
<a name="l00094"></a><a class="code" href="classstdred.html#a25f69a753f0a04e70073cc7f7ecb0a9f">00094</a>    <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classstdred.html#a25f69a753f0a04e70073cc7f7ecb0a9f">TimeToSlot</a>(<span class="keywordtype">double</span> t){<span class="keywordflow">return</span>((<span class="keywordtype">int</span>) (t/<a class="code" href="classstdred.html#a7e3407e655df417bec0a1f993a2dc4b2">SlotLength</a>));};
<a name="l00095"></a><a class="code" href="classstdred.html#ab971b7100f4f162e8dd6eb242a6bc347">00095</a>    <span class="keywordtype">double</span> <a class="code" href="classstdred.html#ab971b7100f4f162e8dd6eb242a6bc347">uniform</a>(){<span class="keywordflow">return</span> <a class="code" href="defs_8h.html#a5c74e39f66195136c4700fe811b32749">my_rand</a>() / 32767.0;}
<a name="l00096"></a>00096 }; <span class="comment">// class stdred</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="preprocessor">#endif  // _STDRED_H_</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Feb 14 12:31:43 2010 for Luayats by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>

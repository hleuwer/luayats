<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Luayats: src/user/tcpiplfnsend.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>src/user/tcpiplfnsend.h</h1><a href="tcpiplfnsend_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">*</span>
<a name="l00003"></a>00003 <span class="comment">*               YATS - Yet Another Tiny Simulator</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">**************************************************************************</span>
<a name="l00006"></a>00006 <span class="comment">*</span>
<a name="l00007"></a>00007 <span class="comment">*     Copyright (C) 1995-1997   Chair for Telecommunications</span>
<a name="l00008"></a>00008 <span class="comment">*                               Dresden University of Technology</span>
<a name="l00009"></a>00009 <span class="comment">*                               D-01062 Dresden</span>
<a name="l00010"></a>00010 <span class="comment">*                               Germany</span>
<a name="l00011"></a>00011 <span class="comment">*</span>
<a name="l00012"></a>00012 <span class="comment">**************************************************************************</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*   This program is free software; you can redistribute it and/or modify</span>
<a name="l00015"></a>00015 <span class="comment">*   it under the terms of the GNU General Public License as published by</span>
<a name="l00016"></a>00016 <span class="comment">*   the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00017"></a>00017 <span class="comment">*   (at your option) any later version.</span>
<a name="l00018"></a>00018 <span class="comment">*</span>
<a name="l00019"></a>00019 <span class="comment">*   This program is distributed in the hope that it will be useful,</span>
<a name="l00020"></a>00020 <span class="comment">*   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00021"></a>00021 <span class="comment">*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00022"></a>00022 <span class="comment">*   GNU General Public License for more details.</span>
<a name="l00023"></a>00023 <span class="comment">*</span>
<a name="l00024"></a>00024 <span class="comment">*   You should have received a copy of the GNU General Public License</span>
<a name="l00025"></a>00025 <span class="comment">*   along with this program; if not, write to the Free Software</span>
<a name="l00026"></a>00026 <span class="comment">*   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l00027"></a>00027 <span class="comment">*</span>
<a name="l00028"></a>00028 <span class="comment">*************************************************************************/</span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef TCPIPLFNSEND_H_</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define TCPIPLFNSEND_H_</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="inxout_8h.html">inxout.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="queue_8h.html">queue.h</a>&quot;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="classtcpiplfnsend.html">00035</a> <span class="keyword">class   </span><a class="code" href="classtcpiplfnsend.html">tcpiplfnsend</a>:   <span class="keyword">public</span> <a class="code" href="classinxout.html">inxout</a>
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037 <span class="keyword">typedef</span> <a class="code" href="classinxout.html">inxout</a>  <a class="code" href="classroot.html">baseclass</a>;
<a name="l00038"></a>00038 <span class="keyword">public</span>:
<a name="l00039"></a><a class="code" href="classtcpiplfnsend.html#aca647ec1425f2cae6b9d6425eeec0f7a">00039</a>                 <a class="code" href="classtcpiplfnsend.html#aca647ec1425f2cae6b9d6425eeec0f7a">tcpiplfnsend</a>(<span class="keywordtype">void</span>):     <a class="code" href="classtcpiplfnsend.html#afab321436a971b4714768a1cadee5a99">evtProcq</a>(<a class="code" href="brdec_8c.html#a50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a1827892938dfc79113304d943d8cc537">keyProcq</a>),
<a name="l00040"></a>00040                                         <a class="code" href="classtcpiplfnsend.html#aa40b6badcd10e086f66f642bdcac71c4">rt_timer</a>(<a class="code" href="brdec_8c.html#a50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a005c058f787f337d40c86681c1287b3c">keyRTO</a>), 
<a name="l00041"></a>00041                                         <a class="code" href="classtcpiplfnsend.html#a24a951a5e7f2043838a8331799649ebf">slowtimo</a>(<a class="code" href="brdec_8c.html#a50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a0235d67580131cf91a399fcf4a264b05">keySlowtimo</a>) {}
<a name="l00042"></a>00042                 
<a name="l00043"></a><a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a0235d67580131cf91a399fcf4a264b05">00043</a>         <span class="keyword">enum</span>    {<a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a1827892938dfc79113304d943d8cc537">keyProcq</a> = 1, <a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a005c058f787f337d40c86681c1287b3c">keyRTO</a> = 2, <a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1aac7f2c5c4b63290cb1e8d568e6dad73f">keyPersist</a> = 3, <a class="code" href="classtcpiplfnsend.html#ab2ccdd806cbcf498758e46a9e57c0bd1a0235d67580131cf91a399fcf4a264b05">keySlowtimo</a> = 4};
<a name="l00044"></a>00044 
<a name="l00045"></a>00045         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a947f538d4c047c628603947917093bdb">init</a>(<span class="keywordtype">void</span>);
<a name="l00046"></a>00046         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a3fd9e171dae9191da410dc151216e9a1">early</a>(<a class="code" href="classevent.html">event</a> *);
<a name="l00047"></a>00047         <a class="code" href="special_8h.html#ab864a03586cda9a5eb915b54be9b7403">rec_typ</a> <a class="code" href="classtcpiplfnsend.html#a64b2a055f59a8eb279911a1cfcc177f1">REC</a>(<a class="code" href="classdata.html">data</a> *, <span class="keywordtype">int</span>);       <span class="comment">// REC() normally expands to rec() (macro for debugging)</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a25348f35e72f10ea2c4ef06e3c542b4a">command</a>(<span class="keywordtype">char</span> *, <a class="code" href="struct__t__t__.html">tok_typ</a> *);
<a name="l00050"></a>00050         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a7a29c3f639f2a72246b5c52f70c6e5a0">export</a>(<a class="code" href="structexp__typ.html">exp_typ</a> *);
<a name="l00051"></a>00051         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a8ef954d6bce22e7d9a00ab3b348d99cf">restim</a>(<span class="keywordtype">void</span>);
<a name="l00052"></a>00052         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a3a64ebca57920f74c68ba7781c76abb5">connect</a>(<span class="keywordtype">void</span>);
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbb">00054</a>         <span class="keyword">enum</span>    <a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbb">TCPsendMode</a> {<a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbba1ec9759a86f203558661fcf405a42748">TCPPlain</a>, <a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbba8ea131ebc7104e3309c9d7c734fab8b9">TCPRetrans</a>, <a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbba4d979563232d9f8f48d63e1c25466143">TCPFastRetrans</a>};
<a name="l00055"></a>00055 
<a name="l00056"></a>00056         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a8cadfbee1c08abb4de7a753a0725752f">calc_send</a>(<a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbb">TCPsendMode</a>);         <span class="comment">// calculate data to send now</span>
<a name="l00057"></a>00057         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#aa91d68b801a084b76111bc9a4a33ca5c">queue_pkt</a>(<span class="keywordtype">int</span>, <a class="code" href="classtcpiplfnsend.html#a0fca3091134a960310db3776ab5a9dbb">TCPsendMode</a>);    <span class="comment">// generates TCP/IP segments of this data</span>
<a name="l00058"></a>00058         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#acb2388ce5a55eb78f1bfb37ff5b3cc02">send_pkt</a>(<span class="keywordtype">void</span>);                 <span class="comment">// sends a packet after processing time expired</span>
<a name="l00059"></a>00059         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a4eb53c3770621e4c79b8f0d9cb3b2f99">process_ack</a>(<a class="code" href="classtcpAck.html">tcpAck</a> *);          <span class="comment">// handles receipt of acknowledges</span>
<a name="l00060"></a>00060 
<a name="l00062"></a>00062          <span class="comment">// new Mue</span>
<a name="l00064"></a>00064 <span class="comment"></span>         <span class="keywordtype">int</span> <a class="code" href="classtcpiplfnsend.html#a5fd721c37c62038b1f4cc831539afe20">limit_cwnd</a>(<span class="keywordtype">int</span> oldcwnd);
<a name="l00065"></a><a class="code" href="classtcpiplfnsend.html#ab4192c47d94b24dcdebd11fac7577ab3">00065</a>          <span class="keywordtype">double</span> <a class="code" href="classtcpiplfnsend.html#ab4192c47d94b24dcdebd11fac7577ab3">wished_rate</a>;     <span class="comment">// rate in bit/s</span>
<a name="l00066"></a><a class="code" href="classtcpiplfnsend.html#a18282a8fad721ff27d0c6bbaf12ef8f9">00066</a>          <span class="keywordtype">double</span> <a class="code" href="classtcpiplfnsend.html#a18282a8fad721ff27d0c6bbaf12ef8f9">rtt_fix</a>;         <span class="comment">// fixed rtt on network</span>
<a name="l00067"></a><a class="code" href="classtcpiplfnsend.html#a9c041b010f95ef6dfa81ab8ec34f8636">00067</a>          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classtcpiplfnsend.html#a9c041b010f95ef6dfa81ab8ec34f8636">wnd_wish</a>;          <span class="comment">// the maximum CWND at the moment</span>
<a name="l00068"></a><a class="code" href="classtcpiplfnsend.html#af00aeb34ad7fe0916df89dd595c1ed9f">00068</a>          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classtcpiplfnsend.html#af00aeb34ad7fe0916df89dd595c1ed9f">wnd_wish_max</a>;      <span class="comment">// the max. CWND at all</span>
<a name="l00069"></a>00069         
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <span class="keyword">inline</span>  <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#aa7c7d04865c12b9dab14977be59e3d0e">min</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>);          <span class="comment">// calculates the minimum value of two integers</span>
<a name="l00072"></a>00072         <span class="keyword">inline</span>  <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a1d2426f828988067c58b22d565906228">max</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>);          <span class="comment">// calculates the maximum value of two integers</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074         <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a502e3ef5a90376cb846282a4017a7a57">ticks_to_slots</a>(<span class="keywordtype">double</span>); <span class="comment">// calculates TCP ticks into slots of simulator</span>
<a name="l00075"></a>00075         <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a47d9ac57c80b4df0f09da03ad9b60459">slots_to_ticks</a>(<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>);
<a name="l00076"></a>00076         <span class="keyword">inline</span>  <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a1d31a89d399cfea337ae9109f142b309">slots_to_secs</a>(<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>);
<a name="l00077"></a>00077         <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#aa0e58c26ed8b2bdf108e98b1bb80fbfc">secs_to_slots</a>(<span class="keywordtype">double</span>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079         <span class="keywordtype">void</span>    <a class="code" href="classtcpiplfnsend.html#a45a3d2cb902615783aabbc25597bad16">tcp_xmit_timer</a>(<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>);        <span class="comment">// calculate new RTO timer from RTT</span>
<a name="l00080"></a>00080         <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#ac4a9871b231574da27310ff1b42db71c">procDelay</a>(<span class="keywordtype">void</span>);        <span class="comment">// returns a processing delay (includes some random)</span>
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="classtcpiplfnsend.html#af75b6126f752f51dbc5ce51a6760c734">00082</a>         <span class="keywordtype">char</span>    *<a class="code" href="classtcpiplfnsend.html#af75b6126f752f51dbc5ce51a6760c734">rec_name</a>;      <span class="comment">// name of receiver part of protocol</span>
<a name="l00083"></a><a class="code" href="classtcpiplfnsend.html#ad0b52f0384c612ff222a5d07175a780f">00083</a>         <a class="code" href="classroot.html">root</a>    *<a class="code" href="classtcpiplfnsend.html#ad0b52f0384c612ff222a5d07175a780f">ptrTcpRecv</a>;    <span class="comment">// pointer to the peer object</span>
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="classtcpiplfnsend.html#a50072c288cfbcee5e240b9db0c6592ce">00085</a>         <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a50072c288cfbcee5e240b9db0c6592ce">tick</a>;           <span class="comment">// TCP tick (default 500msec)</span>
<a name="l00086"></a><a class="code" href="classtcpiplfnsend.html#a0965a0e9d85bfebe7f9e810fe2cccf4d">00086</a>         <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a0965a0e9d85bfebe7f9e810fe2cccf4d">bitrate</a>;        <span class="comment">// bitrate (brutto) of ATM layer (needed to calculate alarms</span>
<a name="l00087"></a>00087                                 <span class="comment">// in slot oriented simulator) in bit/s</span>
<a name="l00088"></a>00088                 
<a name="l00089"></a><a class="code" href="classtcpiplfnsend.html#a2c1e6ec73f2bc2871e050d03d0925ddb">00089</a>         <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a2c1e6ec73f2bc2871e050d03d0925ddb">rto_ub</a>;         <span class="comment">// upper bound of rto (default 64sec)</span>
<a name="l00090"></a><a class="code" href="classtcpiplfnsend.html#a9ffecc16b04d5642e144bf787175a102">00090</a>         <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a9ffecc16b04d5642e144bf787175a102">rto_lb</a>;         <span class="comment">// lower bound of rto (default 1.5sec)</span>
<a name="l00091"></a>00091         
<a name="l00092"></a><a class="code" href="classtcpiplfnsend.html#a3282946ec4af5e6fb4a70690e7f03788">00092</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a3282946ec4af5e6fb4a70690e7f03788">next_send_time</a>; <span class="comment">// next possible send time after done the processing time:</span>
<a name="l00093"></a>00093                                 <span class="comment">// we would like to send, but successor gave StopSend</span>
<a name="l00094"></a><a class="code" href="classtcpiplfnsend.html#ad3fa21992c06e8ec3e370556b852b790">00094</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#ad3fa21992c06e8ec3e370556b852b790">proc_time</a>;      <span class="comment">// processing time; is an estimator of machine speed</span>
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classtcpiplfnsend.html#a0cf6e00f160fdf5a125bd49ed2f140b8">00096</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a0cf6e00f160fdf5a125bd49ed2f140b8">max_seg_size</a>;   <span class="comment">// MSS</span>
<a name="l00097"></a><a class="code" href="classtcpiplfnsend.html#ab9787997b41d3c400dc3599cbaa7504e">00097</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ab9787997b41d3c400dc3599cbaa7504e">MTU</a>;            <span class="comment">// MTU</span>
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classtcpiplfnsend.html#ad87330c903b20f990c07327d26485b71">00099</a>         <a class="code" href="special_8h.html#ab864a03586cda9a5eb915b54be9b7403">rec_typ</a> <a class="code" href="classtcpiplfnsend.html#ad87330c903b20f990c07327d26485b71">prec_state</a>;     <span class="comment">// state of the preceding object</span>
<a name="l00100"></a><a class="code" href="classtcpiplfnsend.html#a56f8cae7cc3bf46670b13a6f46279392">00100</a>         <a class="code" href="special_8h.html#ab864a03586cda9a5eb915b54be9b7403">rec_typ</a> <a class="code" href="classtcpiplfnsend.html#a56f8cae7cc3bf46670b13a6f46279392">send_state</a>;     <span class="comment">// my send state (stopped by successor?)</span>
<a name="l00101"></a>00101 
<a name="l00102"></a><a class="code" href="classtcpiplfnsend.html#a85162f6b3c7a8c7811822e6ac3df7f2e">00102</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a85162f6b3c7a8c7811822e6ac3df7f2e">max_input</a>;      <span class="comment">// size of input buffer</span>
<a name="l00103"></a><a class="code" href="classtcpiplfnsend.html#a91d9fbec7f0e166b0f5e04d6801fa912">00103</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a91d9fbec7f0e166b0f5e04d6801fa912">q_start</a>;        <span class="comment">// input buffer occupation where to wake up stopped data sender</span>
<a name="l00104"></a><a class="code" href="classtcpiplfnsend.html#aad07347507d5960289232779b74e9419">00104</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#aad07347507d5960289232779b74e9419">input_q_len</a>;    <span class="comment">// length of input queue (unacked bytes + bytes waiting to be send)</span>
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classtcpiplfnsend.html#af82285199c2e983881d2740dd867120d">00106</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#af82285199c2e983881d2740dd867120d">nxt_last_rto</a>;   <span class="comment">// sequence number of segment retransmitted at to last RTO</span>
<a name="l00107"></a><a class="code" href="classtcpiplfnsend.html#ae32c9fae699b6cca12010c4ba7ba0670">00107</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ae32c9fae699b6cca12010c4ba7ba0670">abort_cnt</a>;      <span class="comment">// counter of failed retransmissions of the same segment</span>
<a name="l00108"></a><a class="code" href="classtcpiplfnsend.html#a4195235831ff7725d8755548eb42f4f7">00108</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a4195235831ff7725d8755548eb42f4f7">aborted</a>;        <span class="comment">// Flag shows the reset of the connection</span>
<a name="l00109"></a><a class="code" href="classtcpiplfnsend.html#a516d8a28247aa20558a207fa7bc28b81">00109</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a516d8a28247aa20558a207fa7bc28b81">EndSend</a>;        <span class="comment">// Flag shows the end of receiving data from the source </span>
<a name="l00110"></a>00110                                 <span class="comment">//      because of overflow of sequence numbers</span>
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="classtcpiplfnsend.html#a0a0c4a83f7c7ce5b6ecec81158028a66">00112</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a0a0c4a83f7c7ce5b6ecec81158028a66">nagleOff</a>;       <span class="comment">// FALSE (!): Nagle alg. on</span>
<a name="l00113"></a><a class="code" href="classtcpiplfnsend.html#a1de42966ce1dc18710b979aff8f0dc3f">00113</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a1de42966ce1dc18710b979aff8f0dc3f">ph_efOn</a>;        <span class="comment">// FALSE (!): Phase effects ON</span>
<a name="l00114"></a><a class="code" href="classtcpiplfnsend.html#a7dc4f0d72c3c44066a0e9414aa37c356">00114</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a7dc4f0d72c3c44066a0e9414aa37c356">do_timestamp</a>;   <span class="comment">// TRUE: time stamp option acc. to RFC1323 turned on</span>
<a name="l00115"></a><a class="code" href="classtcpiplfnsend.html#a93a1b1872bd43a0b62a64030f2dc0ad9">00115</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a93a1b1872bd43a0b62a64030f2dc0ad9">doFastRetr</a>;     <span class="comment">// TRUE: fast retransmission and recovery turned on</span>
<a name="l00116"></a><a class="code" href="classtcpiplfnsend.html#a2b07cf19ebb2dbd738903038ef217347">00116</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a2b07cf19ebb2dbd738903038ef217347">doLogRetr</a>;      <span class="comment">// TRUE: print log messages for retransmissions</span>
<a name="l00117"></a>00117 
<a name="l00118"></a><a class="code" href="classtcpiplfnsend.html#a9f6cf69707eda105ba62abc781ba234f">00118</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a9f6cf69707eda105ba62abc781ba234f">ip_header_len</a>;  <span class="comment">// length of IP-Header</span>
<a name="l00119"></a><a class="code" href="classtcpiplfnsend.html#ad454fe570e69cb2b8153f84e2a781389">00119</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ad454fe570e69cb2b8153f84e2a781389">tcp_header_len</a>; <span class="comment">// length of TCP-Header</span>
<a name="l00120"></a><a class="code" href="classtcpiplfnsend.html#a7574e8feccb1791493006ac0a80930a4">00120</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a7574e8feccb1791493006ac0a80930a4">ts_option_len</a>;  <span class="comment">// length of Timestamp Options</span>
<a name="l00121"></a>00121         
<a name="l00122"></a><a class="code" href="classtcpiplfnsend.html#ae7701c0b10cfd862287a05e2534b0325">00122</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ae7701c0b10cfd862287a05e2534b0325">nxt</a>;            <span class="comment">// next sequence number of TCP</span>
<a name="l00123"></a><a class="code" href="classtcpiplfnsend.html#ad981c0bfb6d378994ec190e36e0cab05">00123</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ad981c0bfb6d378994ec190e36e0cab05">una</a>;            <span class="comment">// oldest unacknowledged sequence number</span>
<a name="l00124"></a><a class="code" href="classtcpiplfnsend.html#a209aab6bda0c52bae5e8281e0eb178cc">00124</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a209aab6bda0c52bae5e8281e0eb178cc">max_sent</a>;       <span class="comment">// max. sequence number we have sent: only to check ACKs</span>
<a name="l00125"></a>00125         
<a name="l00126"></a><a class="code" href="classtcpiplfnsend.html#a68311688ada2680cdf0740716e56d663">00126</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a68311688ada2680cdf0740716e56d663">wnd</a>;            <span class="comment">// receivers advertised window</span>
<a name="l00127"></a><a class="code" href="classtcpiplfnsend.html#a71b53e0ccb231df039875d3bc151b812">00127</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a71b53e0ccb231df039875d3bc151b812">max_sendwnd</a>;    <span class="comment">// largest window ever advertised by the other end</span>
<a name="l00128"></a><a class="code" href="classtcpiplfnsend.html#a6a1ece83f456bc1fc54e91afe3e1fd02">00128</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a6a1ece83f456bc1fc54e91afe3e1fd02">ssthresh</a>;       <span class="comment">// Slow Start Threshhold</span>
<a name="l00129"></a><a class="code" href="classtcpiplfnsend.html#afa0423cef0e5297049396812a8c102c9">00129</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#afa0423cef0e5297049396812a8c102c9">cwnd</a>;           <span class="comment">// Congestion Window</span>
<a name="l00130"></a><a class="code" href="classtcpiplfnsend.html#ac4432825b0970eca2a5e629c14d3c432">00130</a>         <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#ac4432825b0970eca2a5e629c14d3c432">cwnd_d</a>;         <span class="comment">// aux variable: contains the &quot;exact&quot; cwnd value, from</span>
<a name="l00131"></a>00131                                 <span class="comment">// which the one to use is derived (see process_ack()).</span>
<a name="l00132"></a>00132                                 <span class="comment">// ATTENTION: do always update cwnd_d when changing cwnd,</span>
<a name="l00133"></a>00133                                 <span class="comment">//      exception: opening cwnd in process_ack()</span>
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classtcpiplfnsend.html#a5a2cc62211627fe8255d5ee446d4fa5d">00135</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a5a2cc62211627fe8255d5ee446d4fa5d">seqLastWndUpd</a>;  <span class="comment">// Packet sequence number at last window update</span>
<a name="l00136"></a><a class="code" href="classtcpiplfnsend.html#a7375b81ff597dbb728b844658a3eddd8">00136</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a7375b81ff597dbb728b844658a3eddd8">ackLastWndUpd</a>;  <span class="comment">// Packet acknowledgement number at last window update</span>
<a name="l00137"></a><a class="code" href="classtcpiplfnsend.html#a4a9678df1383e50944f66a18a54e0914">00137</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a4a9678df1383e50944f66a18a54e0914">rexmtthresh</a>;    <span class="comment">// number of duplicate ACKs before fast retransmission</span>
<a name="l00138"></a><a class="code" href="classtcpiplfnsend.html#a05de5e2843bbea2b22cc3faf902c0027">00138</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a05de5e2843bbea2b22cc3faf902c0027">dupacks</a>;        <span class="comment">// counter of consecutive duplicate ACKs (Fast Retransmit)</span>
<a name="l00139"></a>00139         
<a name="l00140"></a><a class="code" href="classtcpiplfnsend.html#ae757f907ead5175e5b11fac281d9b7d1">00140</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ae757f907ead5175e5b11fac281d9b7d1">SA</a>;             <span class="comment">// scaled average of RTT</span>
<a name="l00141"></a><a class="code" href="classtcpiplfnsend.html#a5756b37c7f8e4e4384f9e3a55f8269cc">00141</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a5756b37c7f8e4e4384f9e3a55f8269cc">SD</a>;             <span class="comment">// scaled variance of RTT</span>
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classtcpiplfnsend.html#afab321436a971b4714768a1cadee5a99">00143</a>         <span class="keyword">event</span>   <a class="code" href="classtcpiplfnsend.html#afab321436a971b4714768a1cadee5a99">evtProcq</a>;               <span class="comment">// event to activate output queue</span>
<a name="l00144"></a><a class="code" href="classtcpiplfnsend.html#ad70a39b957d840118aa892510c836069">00144</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ad70a39b957d840118aa892510c836069">active_procq</a>;           <span class="comment">// flag if proc_queue timer is active</span>
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classtcpiplfnsend.html#aa40b6badcd10e086f66f642bdcac71c4">00146</a>         <span class="keyword">event</span>   <a class="code" href="classtcpiplfnsend.html#aa40b6badcd10e086f66f642bdcac71c4">rt_timer</a>;               <span class="comment">// event for retransmission timer</span>
<a name="l00147"></a><a class="code" href="classtcpiplfnsend.html#ac81c1857059d89d50bbd7571d6139e95">00147</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ac81c1857059d89d50bbd7571d6139e95">active_rt_timer</a>;        <span class="comment">// State of retransmission timer (on,off)</span>
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="classtcpiplfnsend.html#a24a951a5e7f2043838a8331799649ebf">00149</a>         <span class="keyword">event</span>   <a class="code" href="classtcpiplfnsend.html#a24a951a5e7f2043838a8331799649ebf">slowtimo</a>;               <span class="comment">// event for slow timer (standard 500msec)</span>
<a name="l00150"></a>00150                                         <span class="comment">// (this timer is always active)</span>
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="classtcpiplfnsend.html#abbb1614fb74fa87feb47b109a722f5b5">00152</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#abbb1614fb74fa87feb47b109a722f5b5">rtt</a>;            <span class="comment">// round trip time in ticks, usage:</span>
<a name="l00153"></a>00153                                 <span class="comment">// if zero: no measurement is in progress</span>
<a name="l00154"></a>00154                                 <span class="comment">// otherwise: measurement running</span>
<a name="l00155"></a><a class="code" href="classtcpiplfnsend.html#a381ebd7f9c64f6334cb00bdfaf679560">00155</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a381ebd7f9c64f6334cb00bdfaf679560">rtseq</a>;          <span class="comment">// sequence number of rtt measurement currently in progress</span>
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="classtcpiplfnsend.html#a0040f9425c458bc370bdd90af235b4d0">00157</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a0040f9425c458bc370bdd90af235b4d0">rto_calc</a>;       <span class="comment">// calculated retransmission timeout (from measurement or timestamp)</span>
<a name="l00158"></a><a class="code" href="classtcpiplfnsend.html#a6d50dfc19fc2a846ff981cd83008b8cf">00158</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a6d50dfc19fc2a846ff981cd83008b8cf">rto_val</a>;        <span class="comment">// value currently used for retransmission timeout</span>
<a name="l00159"></a>00159                                 <span class="comment">// (is doubled with every timeout)</span>
<a name="l00160"></a>00160 
<a name="l00161"></a><a class="code" href="classtcpiplfnsend.html#aee8412893484055347047199e7102f7e">00161</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#aee8412893484055347047199e7102f7e">tcp_now</a>;        <span class="comment">// connection time in ticks</span>
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="classtcpiplfnsend.html#ac8fb6b0b44b9e09d68012eeedcb584d8">00163</a>         <a class="code" href="classuqueue.html">uqueue</a>  <a class="code" href="classtcpiplfnsend.html#ac8fb6b0b44b9e09d68012eeedcb584d8">procq</a>;          <span class="comment">// output processing queue</span>
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="classtcpiplfnsend.html#a7bd72987582b2964f2a55f6bac10ead0a96e71172872ffe306832d269dac696d2">00165</a>         <span class="keyword">enum</span>    {<a class="code" href="classtcpiplfnsend.html#a7bd72987582b2964f2a55f6bac10ead0a96e71172872ffe306832d269dac696d2">SucData</a>=0, <a class="code" href="classtcpiplfnsend.html#a7bd72987582b2964f2a55f6bac10ead0aceac58a8c7ab8e9cf897b1164b488ff4">SucCtrl</a>=1};
<a name="l00166"></a><a class="code" href="classtcpiplfnsend.html#a38bf610816376d71d0202bf1af57c6e8a75f84fa2d8e2cc91c1e97dd20cd74b15">00166</a>         <span class="keyword">enum</span>    {<a class="code" href="classtcpiplfnsend.html#a38bf610816376d71d0202bf1af57c6e8aaa2cc7ffd58d99b76a445999cb1990ba">InpData</a> = 0, <a class="code" href="classtcpiplfnsend.html#a38bf610816376d71d0202bf1af57c6e8a75f84fa2d8e2cc91c1e97dd20cd74b15">InpStart</a> = 1, <a class="code" href="classtcpiplfnsend.html#a38bf610816376d71d0202bf1af57c6e8ab617da8fa8c794d8470713ca55d0713f">InpAck</a> = 2};
<a name="l00167"></a>00167         
<a name="l00168"></a>00168         
<a name="l00169"></a>00169         <span class="comment">// Statistic</span>
<a name="l00170"></a><a class="code" href="classtcpiplfnsend.html#a8aef0744c057feff4da0e2edbda260f0">00170</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a8aef0744c057feff4da0e2edbda260f0">received_bytes</a>;         <span class="comment">// total number of received user bytes</span>
<a name="l00171"></a><a class="code" href="classtcpiplfnsend.html#ab322fd95b5b000809e1acf40cf8df3fc">00171</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ab322fd95b5b000809e1acf40cf8df3fc">xmitted_bytes</a>;          <span class="comment">// total number of xmitted bytes including headers</span>
<a name="l00172"></a><a class="code" href="classtcpiplfnsend.html#a51d956201e190bdd846bb0ead14ccdd0">00172</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a51d956201e190bdd846bb0ead14ccdd0">xmitted_user_bytes</a>;     <span class="comment">// total number of xmitted bytes excluding headers</span>
<a name="l00173"></a><a class="code" href="classtcpiplfnsend.html#a51e7014f25913543bc28c965e0d4bce3">00173</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a51e7014f25913543bc28c965e0d4bce3">xmitted_segments</a>;       <span class="comment">// total number of xmitted segments</span>
<a name="l00174"></a><a class="code" href="classtcpiplfnsend.html#ad7ae752c44cbb52e1d1c04caf9851664">00174</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ad7ae752c44cbb52e1d1c04caf9851664">rexmitted_segments</a>;     <span class="comment">// # of rexmitted segments</span>
<a name="l00175"></a><a class="code" href="classtcpiplfnsend.html#a4628c589e57a2c73d430311ebe50567a">00175</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a4628c589e57a2c73d430311ebe50567a">rexmitted_bytes</a>;        <span class="comment">// # of rexmitted bytes</span>
<a name="l00176"></a><a class="code" href="classtcpiplfnsend.html#adfd9ee0d7c180b6c88ca9afb804dc457">00176</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#adfd9ee0d7c180b6c88ca9afb804dc457">rexmto</a>;                 <span class="comment">// # of retransmission timeouts</span>
<a name="l00177"></a><a class="code" href="classtcpiplfnsend.html#a755cfe735f17dd30767a5fb9c0e0390c">00177</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a755cfe735f17dd30767a5fb9c0e0390c">procq_max_len</a>;          <span class="comment">// maximum length of processing queue in # of segments</span>
<a name="l00178"></a><a class="code" href="classtcpiplfnsend.html#a7d317d5b4667b5c8e1856925c3f87224">00178</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a7d317d5b4667b5c8e1856925c3f87224">inputq_max_len</a>;         <span class="comment">// maximum length of input queue in bytes</span>
<a name="l00179"></a><a class="code" href="classtcpiplfnsend.html#a10fb87427ef294e317b51e40006900e1">00179</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a10fb87427ef294e317b51e40006900e1">received_acks</a>;          <span class="comment">// # of ACKs</span>
<a name="l00180"></a><a class="code" href="classtcpiplfnsend.html#ad628dfeda6d5e0a7c65634f6fbffbdf6">00180</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ad628dfeda6d5e0a7c65634f6fbffbdf6">ackbyte</a>;                <span class="comment">// # of acked bytes</span>
<a name="l00181"></a><a class="code" href="classtcpiplfnsend.html#a7ba8733bd38899526aa141874e1a4c6e">00181</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a7ba8733bd38899526aa141874e1a4c6e">acktoomuch</a>;             <span class="comment">// # of ACKs that acked data that did not even sent</span>
<a name="l00182"></a><a class="code" href="classtcpiplfnsend.html#a368bb84708fa38e40e832b73047bad88">00182</a>         <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a368bb84708fa38e40e832b73047bad88">rexmission_percentage</a>;  <span class="comment">// percentage of rexmissions</span>
<a name="l00183"></a>00183         <span class="comment">// Test Mue ABORT_CNT 15.04.1998</span>
<a name="l00184"></a><a class="code" href="classtcpiplfnsend.html#a9f3ddd66968f300f6a45c7691d9bc23a">00184</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a9f3ddd66968f300f6a45c7691d9bc23a">StatAbortCnt</a>[13];       <span class="comment">// number of unsuccessful retransmissions with abort_cnt of i</span>
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="classtcpiplfnsend.html#ac6b7e25e65afb9c4134488afbd07642b">00186</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ac6b7e25e65afb9c4134488afbd07642b">wnd_min</a>;                <span class="comment">// minimum value of receivers advertised window</span>
<a name="l00187"></a><a class="code" href="classtcpiplfnsend.html#aab5d28e4da0ef7ff5e83f94162ccdaf6">00187</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#aab5d28e4da0ef7ff5e83f94162ccdaf6">wnd_max</a>;                <span class="comment">// maximum value of receivers advertised window</span>
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="classtcpiplfnsend.html#a108ac3a489eeb3bd3b54ccaa71897b06">00189</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a108ac3a489eeb3bd3b54ccaa71897b06">rtt_calc</a>;               <span class="comment">// calculated rtt (round-trip time)</span>
<a name="l00190"></a><a class="code" href="classtcpiplfnsend.html#a3b4d16ec725942e0077c7ea43a4259e8">00190</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a3b4d16ec725942e0077c7ea43a4259e8">rtt_min</a>;                <span class="comment">// minimum rtt</span>
<a name="l00191"></a><a class="code" href="classtcpiplfnsend.html#a73ba00ee9c00c2d851d39ee7fa583d05">00191</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a73ba00ee9c00c2d851d39ee7fa583d05">rtt_max</a>;                <span class="comment">// maximum rtt</span>
<a name="l00192"></a>00192 
<a name="l00193"></a><a class="code" href="classtcpiplfnsend.html#a19529178659d35c1f5675c8d5f76e573">00193</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a19529178659d35c1f5675c8d5f76e573">rtt_real</a>;               <span class="comment">// real rtt (directly measured in the simulator).</span>
<a name="l00194"></a><a class="code" href="classtcpiplfnsend.html#ac02f80d8010815c1a0c91c04e0bd2e38">00194</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#ac02f80d8010815c1a0c91c04e0bd2e38">rtt_real_min</a>;
<a name="l00195"></a><a class="code" href="classtcpiplfnsend.html#a19f2fe4893690d7eeffed380277dc268">00195</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a19f2fe4893690d7eeffed380277dc268">rtt_real_max</a>;
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="classtcpiplfnsend.html#a02da121b2ee7a317f7fc4df9d331899d">00197</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a02da121b2ee7a317f7fc4df9d331899d">rto_min</a>;                <span class="comment">// minimum rto</span>
<a name="l00198"></a><a class="code" href="classtcpiplfnsend.html#a6201bb7c442092f65e07b07187bb5e67">00198</a>         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a6201bb7c442092f65e07b07187bb5e67">rto_max</a>;                <span class="comment">// maximum rto</span>
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="classtcpiplfnsend.html#ae7dbca9273eb9c1e16a2ce2075f2e90f">00200</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ae7dbca9273eb9c1e16a2ce2075f2e90f">connID</a>;                 <span class="comment">// ID of layer 4 connection</span>
<a name="l00201"></a><a class="code" href="classtcpiplfnsend.html#a49885ce6009e55871ebe666f991d52d5">00201</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a49885ce6009e55871ebe666f991d52d5">connIdInitialized</a>;      <span class="comment">// TRUE: connID initialized</span>
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="classtcpiplfnsend.html#a74091480cc695f74e0819688f49c69b2">00203</a>         <span class="keywordtype">unsigned</span>        <a class="code" href="classtcpiplfnsend.html#a74091480cc695f74e0819688f49c69b2">segsReallyRetransmitted</a>;
<a name="l00204"></a><a class="code" href="classtcpiplfnsend.html#aec89c2c5a5de2fb21697f86c9b6bb841">00204</a>         <span class="keywordtype">unsigned</span>        <a class="code" href="classtcpiplfnsend.html#aec89c2c5a5de2fb21697f86c9b6bb841">maxByteReallySent</a>;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 
<a name="l00207"></a><a class="code" href="tcpiplfnsend_8h.html#a9851c7ff84c32343bd23937cecf6231d">00207</a> <span class="preprocessor">#define PROCQTHRESH     (1)</span>
<a name="l00208"></a>00208 <span class="preprocessor"></span><span class="preprocessor">#ifdef  PROCQTHRESH</span>
<a name="l00209"></a><a class="code" href="classtcpiplfnsend.html#a90e5da81315416a7335dca48486c8dbb">00209</a> <span class="preprocessor"></span>        <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a90e5da81315416a7335dca48486c8dbb">calcSendStopped</a>;        <span class="comment">// TRUE: we have stopped enqueuing into</span>
<a name="l00210"></a>00210                                         <span class="comment">// processing queue</span>
<a name="l00211"></a><a class="code" href="classtcpiplfnsend.html#ac0fcfb6b40e00c3dc07dac3d39328eb2">00211</a>         <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#ac0fcfb6b40e00c3dc07dac3d39328eb2">procqThresh</a>;            <span class="comment">// when to begin to do this</span>
<a name="l00212"></a>00212 <span class="preprocessor">#endif</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span>
<a name="l00214"></a>00214 };
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="comment">/********************************************************************/</span>
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classtcpiplfnsend.html#aa7c7d04865c12b9dab14977be59e3d0e">00218</a> <span class="keyword">inline</span>  <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#aa7c7d04865c12b9dab14977be59e3d0e">tcpiplfnsend::min</a>(<span class="keywordtype">int</span> i1, <span class="keywordtype">int</span> i2)
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220         <span class="keywordflow">return</span> i1 &lt;= i2 ? i1 : i2;
<a name="l00221"></a>00221 }
<a name="l00222"></a><a class="code" href="classtcpiplfnsend.html#a1d2426f828988067c58b22d565906228">00222</a> <span class="keyword">inline</span>  <span class="keywordtype">int</span>     <a class="code" href="classtcpiplfnsend.html#a1d2426f828988067c58b22d565906228">tcpiplfnsend::max</a>(<span class="keywordtype">int</span> i1, <span class="keywordtype">int</span> i2)
<a name="l00223"></a>00223 {
<a name="l00224"></a>00224         <span class="keywordflow">return</span> i1 &gt;= i2 ? i1 : i2;
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a><a class="code" href="classtcpiplfnsend.html#a502e3ef5a90376cb846282a4017a7a57">00227</a> <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a502e3ef5a90376cb846282a4017a7a57">tcpiplfnsend::ticks_to_slots</a>(<span class="keywordtype">double</span> d)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> result;
<a name="l00230"></a>00230   
<a name="l00231"></a>00231         <span class="keywordflow">if</span>((result = (<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>) (d * <a class="code" href="classtcpiplfnsend.html#a50072c288cfbcee5e240b9db0c6592ce">tick</a> * <a class="code" href="classtcpiplfnsend.html#a0965a0e9d85bfebe7f9e810fe2cccf4d">bitrate</a> / 53. / 8.)) &lt; 1)
<a name="l00232"></a>00232                 result = 1;     <span class="comment">// avoid slots &lt; 1</span>
<a name="l00233"></a>00233         <span class="keywordflow">return</span> result;
<a name="l00234"></a>00234 }  
<a name="l00235"></a><a class="code" href="classtcpiplfnsend.html#a47d9ac57c80b4df0f09da03ad9b60459">00235</a> <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#a47d9ac57c80b4df0f09da03ad9b60459">tcpiplfnsend::slots_to_ticks</a>(<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> t)
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237         <span class="keywordflow">return</span> (<span class="keywordtype">size_t</span>) ((double)t / <a class="code" href="classtcpiplfnsend.html#a50072c288cfbcee5e240b9db0c6592ce">tick</a> / <a class="code" href="classtcpiplfnsend.html#a0965a0e9d85bfebe7f9e810fe2cccf4d">bitrate</a> * 53. * 8.);
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="classtcpiplfnsend.html#a1d31a89d399cfea337ae9109f142b309">00240</a> <span class="keyword">inline</span>  <span class="keywordtype">double</span>  <a class="code" href="classtcpiplfnsend.html#a1d31a89d399cfea337ae9109f142b309">tcpiplfnsend::slots_to_secs</a>(<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> t)
<a name="l00241"></a>00241 {
<a name="l00242"></a>00242         <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)t / <a class="code" href="classtcpiplfnsend.html#a0965a0e9d85bfebe7f9e810fe2cccf4d">bitrate</a> * 53. * 8.;
<a name="l00243"></a>00243 }
<a name="l00244"></a><a class="code" href="classtcpiplfnsend.html#aa0e58c26ed8b2bdf108e98b1bb80fbfc">00244</a> <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#aa0e58c26ed8b2bdf108e98b1bb80fbfc">tcpiplfnsend::secs_to_slots</a>(<span class="keywordtype">double</span> s)
<a name="l00245"></a>00245 {
<a name="l00246"></a>00246         <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> result;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248         <span class="keywordflow">if</span>((result = (<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>) (s * <a class="code" href="classtcpiplfnsend.html#a0965a0e9d85bfebe7f9e810fe2cccf4d">bitrate</a> / 53. / 8.)) &lt; 1)
<a name="l00249"></a>00249                 result = 1;     <span class="comment">// avoid slots &lt; 1</span>
<a name="l00250"></a>00250         <span class="keywordflow">return</span> result;
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a><a class="code" href="classtcpiplfnsend.html#ac4a9871b231574da27310ff1b42db71c">00253</a> <span class="keyword">inline</span>  <a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpiplfnsend.html#ac4a9871b231574da27310ff1b42db71c">tcpiplfnsend::procDelay</a>(<span class="keywordtype">void</span>) <span class="comment">// change made by Joerg Schueler</span>
<a name="l00254"></a>00254 {
<a name="l00255"></a>00255         <span class="keywordflow">if</span> (<a class="code" href="classtcpiplfnsend.html#a1de42966ce1dc18710b979aff8f0dc3f">ph_efOn</a> == <a class="code" href="defs_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00256"></a>00256            <span class="keywordflow">return</span> (<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>) (<a class="code" href="classtcpiplfnsend.html#ad3fa21992c06e8ec3e370556b852b790">proc_time</a>); <span class="comment">// proctime  </span>
<a name="l00257"></a>00257         <span class="keywordflow">else</span>
<a name="l00258"></a>00258            <span class="keywordflow">return</span> (<a class="code" href="defs_8h.html#ab505b3bd21e0d5447484a2553096f8f2">tim_typ</a>) (<a class="code" href="classtcpiplfnsend.html#ad3fa21992c06e8ec3e370556b852b790">proc_time</a> * (1000.0 + <a class="code" href="defs_8h.html#a5c74e39f66195136c4700fe811b32749">my_rand</a>() % 100) / 1000.0); <span class="comment">// proctime + random  (Random seed ON)</span>
<a name="l00259"></a>00259 }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#endif  // tcpiplfnsend_H_</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Feb 14 12:31:43 2010 for Luayats by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>

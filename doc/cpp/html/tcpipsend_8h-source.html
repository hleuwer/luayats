<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Luayats: src/tcpip/tcpipsend.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>src/tcpip/tcpipsend.h</h1><a href="tcpipsend_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">*</span>
<a name="l00003"></a>00003 <span class="comment">*               YATS - Yet Another Tiny Simulator</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">**************************************************************************</span>
<a name="l00006"></a>00006 <span class="comment">*</span>
<a name="l00007"></a>00007 <span class="comment">*     Copyright (C) 1995-1997   Chair for Telecommunications</span>
<a name="l00008"></a>00008 <span class="comment">*                               Dresden University of Technology</span>
<a name="l00009"></a>00009 <span class="comment">*                               D-01062 Dresden</span>
<a name="l00010"></a>00010 <span class="comment">*                               Germany</span>
<a name="l00011"></a>00011 <span class="comment">*</span>
<a name="l00012"></a>00012 <span class="comment">**************************************************************************</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*   This program is free software; you can redistribute it and/or modify</span>
<a name="l00015"></a>00015 <span class="comment">*   it under the terms of the GNU General Public License as published by</span>
<a name="l00016"></a>00016 <span class="comment">*   the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00017"></a>00017 <span class="comment">*   (at your option) any later version.</span>
<a name="l00018"></a>00018 <span class="comment">*</span>
<a name="l00019"></a>00019 <span class="comment">*   This program is distributed in the hope that it will be useful,</span>
<a name="l00020"></a>00020 <span class="comment">*   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00021"></a>00021 <span class="comment">*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00022"></a>00022 <span class="comment">*   GNU General Public License for more details.</span>
<a name="l00023"></a>00023 <span class="comment">*</span>
<a name="l00024"></a>00024 <span class="comment">*   You should have received a copy of the GNU General Public License</span>
<a name="l00025"></a>00025 <span class="comment">*   along with this program; if not, write to the Free Software</span>
<a name="l00026"></a>00026 <span class="comment">*   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l00027"></a>00027 <span class="comment">*</span>
<a name="l00028"></a>00028 <span class="comment">*************************************************************************/</span>
<a name="l00029"></a>00029 <span class="preprocessor">#ifndef TCPIPSEND_H_</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#define TCPIPSEND_H_</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="inxout_8h.html">inxout.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="queue_8h.html">queue.h</a>"</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">//tolua_begin</span>
<a name="l00036"></a><a class="code" href="classtcpipsend.html">00036</a> <span class="keyword">class </span><a class="code" href="classtcpipsend.html">tcpipsend</a>: <span class="keyword">public</span> <a class="code" href="classinxout.html">inxout</a>
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038   <span class="keyword">typedef</span>       <a class="code" href="classinxout.html">inxout</a>  <a class="code" href="classroot.html">baseclass</a>;
<a name="l00039"></a>00039 <span class="keyword">public</span>:
<a name="l00040"></a><a class="code" href="classtcpipsend.html#6c0b42812ed5056b9926382e8e418325">00040</a>   <a class="code" href="classtcpipsend.html#6c0b42812ed5056b9926382e8e418325">tcpipsend</a>(<span class="keywordtype">void</span>): <a class="code" href="classtcpipsend.html#d568d8d921d07f3582d79281e6721a4a">evtProcq</a>(<a class="code" href="brdec_8c.html#50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24bb209990a1239cd1e6d101cc2523f4817">keyProcq</a>),
<a name="l00041"></a>00041                    <a class="code" href="classtcpipsend.html#1db29f6b040cdb8f78653559a4cb649f">rt_timer</a>(<a class="code" href="brdec_8c.html#50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24b57e7e4a1a824f9ec154b0838e15eaedf">keyRTO</a>), 
<a name="l00042"></a>00042                    <a class="code" href="classtcpipsend.html#af40d2965c25628f8b1cf9bd36beb623">slowtimo</a>(<a class="code" href="brdec_8c.html#50383951d2a9d4f1a855b2cec5e03274">this</a>, <a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24b53ee35b59da13490a2b0e10d351fe3aa">keySlowtimo</a>){}
<a name="l00043"></a><a class="code" href="classtcpipsend.html#c00f2edc91f56cf31fb1f6407d9c945e">00043</a>   <a class="code" href="classtcpipsend.html#c00f2edc91f56cf31fb1f6407d9c945e">~tcpipsend</a>(){};
<a name="l00044"></a>00044   <span class="keywordtype">int</span> <a class="code" href="classtcpipsend.html#695b7759524560456638f9fb6c8037e4" title="Implemented Algorithms ======================Slow start and congestion avoidanceSilly...">act</a>(<span class="keywordtype">void</span>);
<a name="l00045"></a>00045 
<a name="l00046"></a>00046   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#1f75a349c9cc0ddf44f814351fff06a5">early</a>(<a class="code" href="classevent.html">event</a> *);
<a name="l00047"></a>00047   <span class="comment">// REC() normally expands to rec() (macro for debugging)</span>
<a name="l00048"></a>00048   <a class="code" href="special_8h.html#b864a03586cda9a5eb915b54be9b7403">rec_typ</a> <a class="code" href="classtcpipsend.html#3667e8f62da22cf0b77a6c5d8c4bb616">REC</a>(<a class="code" href="classdata.html">data</a> *, <span class="keywordtype">int</span>);
<a name="l00049"></a>00049   
<a name="l00050"></a>00050   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#5d47565147c0ab9bdd4c48f5b0fd42bd">export</a>(<a class="code" href="structexp__typ.html">exp_typ</a> *);
<a name="l00051"></a>00051   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#142def5f607b91557f33c7d40b6fd334">restim</a>(<span class="keywordtype">void</span>);
<a name="l00052"></a>00052   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#cfec4bd4336d178f6f54377856b9e002">connectact</a>(<a class="code" href="classroot.html">root</a> *);
<a name="l00053"></a>00053   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#007c3fffda0b4fd931c05045674647e1">resetStat</a>(<span class="keywordtype">void</span>);
<a name="l00054"></a><a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f5">00054</a>   <span class="keyword">enum</span>  <a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f5">TCPsendMode</a> {<a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f5e63303704e9cc3495fe3df5867a786c8">TCPPlain</a>, <a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f5061ab407e8cc075f83be2661d012216c">TCPRetrans</a>, <a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f57025ba956cd6623e2e2862f0cd95c96e">TCPFastRetrans</a>};
<a name="l00055"></a>00055   
<a name="l00056"></a>00056   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#bdb79d1d38dd5282983e1df366d3099e">calc_send</a>(<a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f5">TCPsendMode</a>);         <span class="comment">// calculate data to send now</span>
<a name="l00057"></a>00057   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#fc37d7fd7d4933ebda45cfbf1639e16d">queue_pkt</a>(<span class="keywordtype">int</span>, <a class="code" href="classtcpipsend.html#3780841e8a69137f3a2996e80907a6f5">TCPsendMode</a>);    <span class="comment">// generates TCP/IP segments of this data</span>
<a name="l00058"></a>00058   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#326ed3871514b48c8ea509ee793c34a8">send_pkt</a>(<span class="keywordtype">void</span>);                 <span class="comment">// sends a packet after processing time expired</span>
<a name="l00059"></a>00059   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#6e387be60c5bdde884093f32757443ab">process_ack</a>(<a class="code" href="classtcpAck.html">tcpAck</a> *);          <span class="comment">// handles receipt of acknowledges</span>
<a name="l00060"></a>00060   
<a name="l00061"></a>00061   <span class="keywordtype">int</span>     <a class="code" href="classtcpipsend.html#4c2895ceb563d38253817866b5439e4a">min</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>);                <span class="comment">// calculates the minimum value of two integers</span>
<a name="l00062"></a>00062   <span class="keywordtype">int</span>     <a class="code" href="classtcpipsend.html#7927e96cfeffd0a05d161bd1a513fb50">max</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>);                <span class="comment">// calculates the maximum value of two integers</span>
<a name="l00063"></a>00063   
<a name="l00064"></a>00064   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpipsend.html#8a8b496eaa28c2faf7d20c5e7f5378ea">ticks_to_slots</a>(<span class="keywordtype">double</span>);       <span class="comment">// calculates TCP ticks into slots of simulator</span>
<a name="l00065"></a>00065   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpipsend.html#12f0978e9f92a00c409759ca833010e4">slots_to_ticks</a>(<a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>);
<a name="l00066"></a>00066   <span class="keywordtype">double</span> <a class="code" href="classtcpipsend.html#89034ee74cd6f331be1a34c721be51ce">slots_to_secs</a>(<a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>);
<a name="l00067"></a>00067   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpipsend.html#5967c9cd629acac479ad5ea8b1ee0097">secs_to_slots</a>(<span class="keywordtype">double</span>);
<a name="l00068"></a>00068   
<a name="l00069"></a>00069   <span class="keywordtype">void</span>  <a class="code" href="classtcpipsend.html#b29b5c4d5b7227766e6f6a3be709fe56">tcp_xmit_timer</a>(<a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>);        <span class="comment">// calculate new RTO timer from RTT</span>
<a name="l00070"></a>00070   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a> <a class="code" href="classtcpipsend.html#d819898e58a22384bd567ed1163bb3c4">procDelay</a>(<span class="keywordtype">void</span>);      <span class="comment">// returns a processing delay (includes some random)</span>
<a name="l00071"></a>00071   
<a name="l00072"></a><a class="code" href="classtcpipsend.html#96dbb5cb38750b95f9a7c6370468adc3">00072</a>   <span class="keywordtype">char</span>  *<a class="code" href="classtcpipsend.html#96dbb5cb38750b95f9a7c6370468adc3">rec_name</a>;      <span class="comment">// name of receiver part of protocol</span>
<a name="l00073"></a><a class="code" href="classtcpipsend.html#330ade53524a191fc61a7fc05201c829">00073</a>   <a class="code" href="classroot.html">root</a>  *<a class="code" href="classtcpipsend.html#330ade53524a191fc61a7fc05201c829">ptrTcpRecv</a>;    <span class="comment">// pointer to the peer object</span>
<a name="l00074"></a>00074   
<a name="l00075"></a><a class="code" href="classtcpipsend.html#b38eb72c1f9085380730aca815466ef8">00075</a>   <span class="keywordtype">double</span>        <a class="code" href="classtcpipsend.html#b38eb72c1f9085380730aca815466ef8">tick</a>;           <span class="comment">// TCP tick (default 500msec)</span>
<a name="l00076"></a><a class="code" href="classtcpipsend.html#1d4d6099eb1e1e748d1e70fe45b0f6fd">00076</a>   <span class="keywordtype">double</span>        <a class="code" href="classtcpipsend.html#1d4d6099eb1e1e748d1e70fe45b0f6fd">bitrate</a>;        <span class="comment">// bitrate (brutto) of ATM layer (needed to calculate alarms</span>
<a name="l00077"></a>00077                                 <span class="comment">// in slot oriented simulator) in bit/s</span>
<a name="l00078"></a>00078   
<a name="l00079"></a><a class="code" href="classtcpipsend.html#3036108c2492ba1d71f349d35adcb14f">00079</a>   <span class="keywordtype">double</span>        <a class="code" href="classtcpipsend.html#3036108c2492ba1d71f349d35adcb14f">rto_ub</a>;         <span class="comment">// upper bound of rto (default 64sec)</span>
<a name="l00080"></a><a class="code" href="classtcpipsend.html#9c47fed6f379f72edbd184c7e4201961">00080</a>   <span class="keywordtype">double</span>        <a class="code" href="classtcpipsend.html#9c47fed6f379f72edbd184c7e4201961">rto_lb</a>;         <span class="comment">// lower bound of rto (default 1.5sec)</span>
<a name="l00081"></a>00081   
<a name="l00082"></a><a class="code" href="classtcpipsend.html#eda324d3c9bc955b4bf011fbc0d13a84">00082</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#eda324d3c9bc955b4bf011fbc0d13a84">next_send_time</a>; <span class="comment">// next possible send time after done the processing time:</span>
<a name="l00083"></a>00083                                 <span class="comment">// we would like to send, but successor gave StopSend</span>
<a name="l00084"></a><a class="code" href="classtcpipsend.html#ef8ef0ba3dfe23c4d82d3abcee5bcfc4">00084</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#ef8ef0ba3dfe23c4d82d3abcee5bcfc4">proc_time</a>;      <span class="comment">// processing time; is an estimator of machine speed</span>
<a name="l00085"></a>00085   
<a name="l00086"></a><a class="code" href="classtcpipsend.html#ff96f065116f0fe6041485926d3e1019">00086</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#ff96f065116f0fe6041485926d3e1019">max_seg_size</a>;   <span class="comment">// MSS</span>
<a name="l00087"></a><a class="code" href="classtcpipsend.html#b6d54b5de4b0e45b756a50466959d53d">00087</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#b6d54b5de4b0e45b756a50466959d53d">MTU</a>;            <span class="comment">// MTU</span>
<a name="l00088"></a>00088   
<a name="l00089"></a><a class="code" href="classtcpipsend.html#174c89a8e0ba8c46b57363b4a4b9e72d">00089</a>   <a class="code" href="special_8h.html#b864a03586cda9a5eb915b54be9b7403">rec_typ</a>       <a class="code" href="classtcpipsend.html#174c89a8e0ba8c46b57363b4a4b9e72d">prec_state</a>;     <span class="comment">// state of the preceding object</span>
<a name="l00090"></a><a class="code" href="classtcpipsend.html#23d38d1204423f3fff599f0e74a88ed2">00090</a>   <a class="code" href="special_8h.html#b864a03586cda9a5eb915b54be9b7403">rec_typ</a>       <a class="code" href="classtcpipsend.html#23d38d1204423f3fff599f0e74a88ed2">send_state</a>;     <span class="comment">// my send state (stopped by successor?)</span>
<a name="l00091"></a>00091   
<a name="l00092"></a><a class="code" href="classtcpipsend.html#395d2f3af15187a55489bad9b8cb0c52">00092</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#395d2f3af15187a55489bad9b8cb0c52">max_input</a>;      <span class="comment">// size of input buffer</span>
<a name="l00093"></a><a class="code" href="classtcpipsend.html#6a4836fa1bb6bf4d5f53c5165a0d4132">00093</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#6a4836fa1bb6bf4d5f53c5165a0d4132">q_start</a>;        <span class="comment">// input buffer occupation where to wake up stopped data sender</span>
<a name="l00094"></a><a class="code" href="classtcpipsend.html#3f628d07aa85c6f7777b1368c38cb47b">00094</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#3f628d07aa85c6f7777b1368c38cb47b">input_q_len</a>;    <span class="comment">// length of input queue (unacked bytes + bytes waiting to be send)</span>
<a name="l00095"></a>00095   
<a name="l00096"></a><a class="code" href="classtcpipsend.html#adf449baa62536ae6af91208db00a817">00096</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#adf449baa62536ae6af91208db00a817">nxt_last_rto</a>;   <span class="comment">// sequence number of segment retransmitted at to last RTO</span>
<a name="l00097"></a><a class="code" href="classtcpipsend.html#062490c4394da1749c1c34c720bdf338">00097</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#062490c4394da1749c1c34c720bdf338">abort_cnt</a>;      <span class="comment">// counter of failed retransmissions of the same segment</span>
<a name="l00098"></a><a class="code" href="classtcpipsend.html#08f0ad362bbde2c061959d3a3efb1161">00098</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#08f0ad362bbde2c061959d3a3efb1161">aborted</a>;        <span class="comment">// Flag shows the reset of the connection</span>
<a name="l00099"></a><a class="code" href="classtcpipsend.html#ce253599385a469c4508af4e75d29fed">00099</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#ce253599385a469c4508af4e75d29fed">EndSend</a>;        <span class="comment">// Flag shows the end of receiving data from the source </span>
<a name="l00100"></a>00100   <span class="comment">//    because of overflow of sequence numbers</span>
<a name="l00101"></a>00101   
<a name="l00102"></a><a class="code" href="classtcpipsend.html#be528f326f3233cbc59575f2b789d933">00102</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#be528f326f3233cbc59575f2b789d933">nagleOff</a>;       <span class="comment">// FALSE (!): Nagle alg. on</span>
<a name="l00103"></a><a class="code" href="classtcpipsend.html#b481ee9ef4357c2145610eefc772eb3d">00103</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#b481ee9ef4357c2145610eefc772eb3d">ph_efOn</a>;        <span class="comment">// FALSE (!): Phase effects ON</span>
<a name="l00104"></a><a class="code" href="classtcpipsend.html#324eb08153c21cd16c20c35b52515243">00104</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#324eb08153c21cd16c20c35b52515243">do_timestamp</a>;   <span class="comment">// TRUE: time stamp option acc. to RFC1323 turned on</span>
<a name="l00105"></a><a class="code" href="classtcpipsend.html#a8b05b37411064c4ff588c1a859d2c83">00105</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#a8b05b37411064c4ff588c1a859d2c83">doFastRetr</a>;     <span class="comment">// TRUE: fast retransmission and recovery turned on</span>
<a name="l00106"></a><a class="code" href="classtcpipsend.html#d5c537796cd4e8c18963a2fb57c81783">00106</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#d5c537796cd4e8c18963a2fb57c81783">doLogRetr</a>;      <span class="comment">// TRUE: print log messages for retransmissions</span>
<a name="l00107"></a>00107   
<a name="l00108"></a><a class="code" href="classtcpipsend.html#7875caddd99bca7b7dd02a074012902e">00108</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#7875caddd99bca7b7dd02a074012902e">ip_header_len</a>;  <span class="comment">// length of IP-Header</span>
<a name="l00109"></a><a class="code" href="classtcpipsend.html#6a05f20067ee90d4fade15480fe7eaa7">00109</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#6a05f20067ee90d4fade15480fe7eaa7">tcp_header_len</a>; <span class="comment">// length of TCP-Header</span>
<a name="l00110"></a><a class="code" href="classtcpipsend.html#f32e673e8715c5c8da3cf823b63c5616">00110</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#f32e673e8715c5c8da3cf823b63c5616">ts_option_len</a>;  <span class="comment">// length of Timestamp Options</span>
<a name="l00111"></a>00111   
<a name="l00112"></a><a class="code" href="classtcpipsend.html#725229853a6152f721b84af3f9a5cf6d">00112</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#725229853a6152f721b84af3f9a5cf6d">nxt</a>;            <span class="comment">// next sequence number of TCP</span>
<a name="l00113"></a><a class="code" href="classtcpipsend.html#bddc683338c46c1b088aa00356e95038">00113</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#bddc683338c46c1b088aa00356e95038">una</a>;            <span class="comment">// oldest unacknowledged sequence number</span>
<a name="l00114"></a><a class="code" href="classtcpipsend.html#65e41736ca97d5f94f71d471631c18d5">00114</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#65e41736ca97d5f94f71d471631c18d5">max_sent</a>;       <span class="comment">// max. sequence number we have sent: only to check ACKs</span>
<a name="l00115"></a>00115   
<a name="l00116"></a><a class="code" href="classtcpipsend.html#a5cd3258dac9bfb936d1186f5ab852f6">00116</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#a5cd3258dac9bfb936d1186f5ab852f6">wnd</a>;            <span class="comment">// receivers advertised window</span>
<a name="l00117"></a><a class="code" href="classtcpipsend.html#ee1159d7d61583c8f678a978ea9403b6">00117</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#ee1159d7d61583c8f678a978ea9403b6">max_sendwnd</a>;    <span class="comment">// largest window ever advertised by the other end</span>
<a name="l00118"></a><a class="code" href="classtcpipsend.html#d8510daffb80b89d067eec04f0758ec5">00118</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#d8510daffb80b89d067eec04f0758ec5">ssthresh</a>;       <span class="comment">// Slow Start Threshhold</span>
<a name="l00119"></a><a class="code" href="classtcpipsend.html#0661db755e3da7874da28765163b361f">00119</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#0661db755e3da7874da28765163b361f">cwnd</a>;           <span class="comment">// Congestion Window</span>
<a name="l00120"></a><a class="code" href="classtcpipsend.html#520921e092f1b57077d62cd4691a87bd">00120</a>   <span class="keywordtype">double</span>        <a class="code" href="classtcpipsend.html#520921e092f1b57077d62cd4691a87bd">cwnd_d</a>;         <span class="comment">// aux variable: contains the "exact" cwnd value, from</span>
<a name="l00121"></a>00121                                 <span class="comment">// which the one to use is derived (see process_ack()).</span>
<a name="l00122"></a>00122                                 <span class="comment">// ATTENTION: do always update cwnd_d when changing cwnd,</span>
<a name="l00123"></a>00123                                 <span class="comment">//      exception: opening cwnd in process_ack()</span>
<a name="l00124"></a>00124   
<a name="l00125"></a><a class="code" href="classtcpipsend.html#a425aac32f3414f9358fa7feaeadb656">00125</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#a425aac32f3414f9358fa7feaeadb656">seqLastWndUpd</a>;  <span class="comment">// Packet sequence number at last window update</span>
<a name="l00126"></a><a class="code" href="classtcpipsend.html#a0c70c1100cc3ccde1e068286049e58a">00126</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#a0c70c1100cc3ccde1e068286049e58a">ackLastWndUpd</a>;  <span class="comment">// Packet acknowledgement number at last window update</span>
<a name="l00127"></a><a class="code" href="classtcpipsend.html#098020ecd95777ce1ef9964645346af1">00127</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#098020ecd95777ce1ef9964645346af1">rexmtthresh</a>;    <span class="comment">// number of duplicate ACKs before fast retransmission</span>
<a name="l00128"></a><a class="code" href="classtcpipsend.html#6705a5f0a19bd5861a9c4a6c6e18bf96">00128</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#6705a5f0a19bd5861a9c4a6c6e18bf96">dupacks</a>;        <span class="comment">// counter of consecutive duplicate ACKs (Fast Retransmit)</span>
<a name="l00129"></a>00129   
<a name="l00130"></a><a class="code" href="classtcpipsend.html#8b92cd40419bf567ef07af7d0cbd541d">00130</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#8b92cd40419bf567ef07af7d0cbd541d">SA</a>;             <span class="comment">// scaled average of RTT</span>
<a name="l00131"></a><a class="code" href="classtcpipsend.html#6174629750472a0526c1ca4cb3154fcb">00131</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#6174629750472a0526c1ca4cb3154fcb">SD</a>;             <span class="comment">// scaled variance of RTT</span>
<a name="l00132"></a>00132   
<a name="l00133"></a><a class="code" href="classtcpipsend.html#d568d8d921d07f3582d79281e6721a4a">00133</a>   <span class="keyword">event</span> <a class="code" href="classtcpipsend.html#d568d8d921d07f3582d79281e6721a4a">evtProcq</a>;               <span class="comment">// event to activate output queue</span>
<a name="l00134"></a><a class="code" href="classtcpipsend.html#9f3be0cc4f1f40ad26ba9fd2de0cd400">00134</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#9f3be0cc4f1f40ad26ba9fd2de0cd400">active_procq</a>;           <span class="comment">// flag if proc_queue timer is active</span>
<a name="l00135"></a>00135   
<a name="l00136"></a><a class="code" href="classtcpipsend.html#1db29f6b040cdb8f78653559a4cb649f">00136</a>   <span class="keyword">event</span> <a class="code" href="classtcpipsend.html#1db29f6b040cdb8f78653559a4cb649f">rt_timer</a>;               <span class="comment">// event for retransmission timer</span>
<a name="l00137"></a><a class="code" href="classtcpipsend.html#c349113bfb405392dfa57d79563d7966">00137</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#c349113bfb405392dfa57d79563d7966">active_rt_timer</a>;        <span class="comment">// State of retransmission timer (on,off)</span>
<a name="l00138"></a>00138   
<a name="l00139"></a><a class="code" href="classtcpipsend.html#af40d2965c25628f8b1cf9bd36beb623">00139</a>   <span class="keyword">event</span> <a class="code" href="classtcpipsend.html#af40d2965c25628f8b1cf9bd36beb623">slowtimo</a>;               <span class="comment">// event for slow timer (standard 500msec)</span>
<a name="l00140"></a>00140   <span class="comment">// (this timer is always active)</span>
<a name="l00141"></a>00141   
<a name="l00142"></a><a class="code" href="classtcpipsend.html#5bb924ec39955a9636e49d0903bdb7a9">00142</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#5bb924ec39955a9636e49d0903bdb7a9">rtt</a>;            <span class="comment">// round trip time in ticks, usage:</span>
<a name="l00143"></a>00143                         <span class="comment">// if zero: no measurement is in progress</span>
<a name="l00144"></a>00144                         <span class="comment">// otherwise: measurement running</span>
<a name="l00145"></a><a class="code" href="classtcpipsend.html#1db053b21d5b185735fee9feae9fc110">00145</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#1db053b21d5b185735fee9feae9fc110">rtseq</a>;          <span class="comment">// sequence number of rtt measurement currently in progress</span>
<a name="l00146"></a>00146   
<a name="l00147"></a><a class="code" href="classtcpipsend.html#0fa5070852c97ad2e5b84540aacabba1">00147</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#0fa5070852c97ad2e5b84540aacabba1">rto_calc</a>;       <span class="comment">// calculated retransmission timeout (from measurement or timestamp)</span>
<a name="l00148"></a><a class="code" href="classtcpipsend.html#f458eae934ce7242615526e1fdbafe53">00148</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#f458eae934ce7242615526e1fdbafe53">rto_val</a>;        <span class="comment">// value currently used for retransmission timeout</span>
<a name="l00149"></a>00149                                 <span class="comment">// (is doubled with every timeout)</span>
<a name="l00150"></a>00150   
<a name="l00151"></a><a class="code" href="classtcpipsend.html#dddbe8064ca073221eb7fabe4e42b82f">00151</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#dddbe8064ca073221eb7fabe4e42b82f">tcp_now</a>;        <span class="comment">// connection time in ticks</span>
<a name="l00152"></a>00152   
<a name="l00153"></a><a class="code" href="classtcpipsend.html#c91d523de2fa0c7b06a61baf10abfba2">00153</a>   <a class="code" href="classuqueue.html">uqueue</a>        <a class="code" href="classtcpipsend.html#c91d523de2fa0c7b06a61baf10abfba2">procq</a>;          <span class="comment">// output processing queue</span>
<a name="l00154"></a>00154   
<a name="l00155"></a><a class="code" href="classtcpipsend.html#7f0d09dddb591abd349e3447c8e398c9b9063d356f70e0f5cb1a8735bc1171b4">00155</a>   <span class="keyword">enum</span>  {<a class="code" href="classtcpipsend.html#7f0d09dddb591abd349e3447c8e398c9b9063d356f70e0f5cb1a8735bc1171b4">SucData</a>=0, <a class="code" href="classtcpipsend.html#7f0d09dddb591abd349e3447c8e398c977965bfa76f47f75e761d2507ffcc2a7">SucCtrl</a>=1};
<a name="l00156"></a><a class="code" href="classtcpipsend.html#d30de9dd1f88a1ae39340edf7222b533ae41364640e55059d02a9985ea2030e7">00156</a>   <span class="keyword">enum</span>  {<a class="code" href="classtcpipsend.html#d30de9dd1f88a1ae39340edf7222b533ed838d12c84991230af88c00cae48efe">InpData</a> = 0, <a class="code" href="classtcpipsend.html#d30de9dd1f88a1ae39340edf7222b533ae41364640e55059d02a9985ea2030e7">InpStart</a> = 1, <a class="code" href="classtcpipsend.html#d30de9dd1f88a1ae39340edf7222b533689d9fa8a2456ee7120bcf12ab5531cb">InpAck</a> = 2};
<a name="l00157"></a>00157   
<a name="l00158"></a>00158   
<a name="l00159"></a>00159   <span class="comment">// Statistic</span>
<a name="l00160"></a><a class="code" href="classtcpipsend.html#9a0cea8bb37357a1bda28428b28051ac">00160</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#9a0cea8bb37357a1bda28428b28051ac">received_bytes</a>;         <span class="comment">// total number of received user bytes</span>
<a name="l00161"></a><a class="code" href="classtcpipsend.html#15cefc98ae8663beb6b00fbea32b7895">00161</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#15cefc98ae8663beb6b00fbea32b7895">xmitted_bytes</a>;          <span class="comment">// total number of xmitted bytes including headers</span>
<a name="l00162"></a><a class="code" href="classtcpipsend.html#7df583833eb78022ee5c14b70d1c0b2b">00162</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#7df583833eb78022ee5c14b70d1c0b2b">xmitted_user_bytes</a>;     <span class="comment">// total number of xmitted bytes excluding headers</span>
<a name="l00163"></a><a class="code" href="classtcpipsend.html#bd85d1f8b4f3c8421f752588eae80767">00163</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#bd85d1f8b4f3c8421f752588eae80767">xmitted_segments</a>;       <span class="comment">// total number of xmitted segments</span>
<a name="l00164"></a><a class="code" href="classtcpipsend.html#9d816bf3e09042d4e8269b98fa521ab0">00164</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#9d816bf3e09042d4e8269b98fa521ab0">rexmitted_segments</a>;     <span class="comment">// # of rexmitted segments</span>
<a name="l00165"></a><a class="code" href="classtcpipsend.html#54d4a3edd9bf5fd82afb1f78b3ad113f">00165</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#54d4a3edd9bf5fd82afb1f78b3ad113f">rexmitted_bytes</a>;        <span class="comment">// # of rexmitted bytes</span>
<a name="l00166"></a><a class="code" href="classtcpipsend.html#8bbf8a95e3d2922fa82c13f3c6016f0b">00166</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#8bbf8a95e3d2922fa82c13f3c6016f0b">rexmto</a>;                 <span class="comment">// # of retransmission timeouts</span>
<a name="l00167"></a><a class="code" href="classtcpipsend.html#2e0b741afb6e96feae917357124a1f96">00167</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#2e0b741afb6e96feae917357124a1f96">procq_max_len</a>;          <span class="comment">// maximum length of processing queue in # of segments</span>
<a name="l00168"></a><a class="code" href="classtcpipsend.html#bc51841dd213fcd1a202d7d9bb65733e">00168</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#bc51841dd213fcd1a202d7d9bb65733e">inputq_max_len</a>;         <span class="comment">// maximum length of input queue in bytes</span>
<a name="l00169"></a><a class="code" href="classtcpipsend.html#88e0acd2697d70394ed46be87abad669">00169</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#88e0acd2697d70394ed46be87abad669">received_acks</a>;          <span class="comment">// # of ACKs</span>
<a name="l00170"></a><a class="code" href="classtcpipsend.html#b7835ff490339c1cda52c63aad1daa11">00170</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#b7835ff490339c1cda52c63aad1daa11">ackbyte</a>;                <span class="comment">// # of acked bytes</span>
<a name="l00171"></a><a class="code" href="classtcpipsend.html#8671493bf4002ddb87bc0f7b61dc17be">00171</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#8671493bf4002ddb87bc0f7b61dc17be">acktoomuch</a>;             <span class="comment">// # of ACKs that acked data that did not even sent</span>
<a name="l00172"></a><a class="code" href="classtcpipsend.html#d7d7a164ffd0793192a22f325cd2405e">00172</a>   <span class="keywordtype">double</span>        <a class="code" href="classtcpipsend.html#d7d7a164ffd0793192a22f325cd2405e">rexmission_percentage</a>;  <span class="comment">// percentage of rexmissions</span>
<a name="l00173"></a>00173   <span class="comment">// Test Mue ABORT_CNT 15.04.1998</span>
<a name="l00174"></a><a class="code" href="classtcpipsend.html#1cf83a6a04668a78faad3d361611e8c4">00174</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#1cf83a6a04668a78faad3d361611e8c4">StatAbortCnt</a>[13];       <span class="comment">// number of unsuccessful retransmissions with abort_cnt of i</span>
<a name="l00175"></a>00175   
<a name="l00176"></a><a class="code" href="classtcpipsend.html#1bc51d94617abc277524ae2bd48c49d9">00176</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#1bc51d94617abc277524ae2bd48c49d9">wnd_min</a>;                <span class="comment">// minimum value of receivers advertised window</span>
<a name="l00177"></a><a class="code" href="classtcpipsend.html#103d4b1fe81eea728a4728179da77017">00177</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#103d4b1fe81eea728a4728179da77017">wnd_max</a>;                <span class="comment">// maximum value of receivers advertised window</span>
<a name="l00178"></a>00178   
<a name="l00179"></a><a class="code" href="classtcpipsend.html#bff759bd0325d8f29cb9f97ef7c4e5f5">00179</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#bff759bd0325d8f29cb9f97ef7c4e5f5">rtt_calc</a>;               <span class="comment">// calculated rtt (round-trip time)</span>
<a name="l00180"></a><a class="code" href="classtcpipsend.html#39f2a2712a6cff36e8d33c1b3471718c">00180</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#39f2a2712a6cff36e8d33c1b3471718c">rtt_min</a>;                <span class="comment">// minimum rtt</span>
<a name="l00181"></a><a class="code" href="classtcpipsend.html#a7e856417f353b35df5c3a3dc205fdd4">00181</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#a7e856417f353b35df5c3a3dc205fdd4">rtt_max</a>;                <span class="comment">// maximum rtt</span>
<a name="l00182"></a>00182   
<a name="l00183"></a><a class="code" href="classtcpipsend.html#b7f672430bfa8b8e1a81220b9ae32cde">00183</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#b7f672430bfa8b8e1a81220b9ae32cde">rtt_real</a>;               <span class="comment">// real rtt (directly measured in the simulator).</span>
<a name="l00184"></a><a class="code" href="classtcpipsend.html#fabcc4d9b454442d60bf00cbbd1e2368">00184</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#fabcc4d9b454442d60bf00cbbd1e2368">rtt_real_min</a>;
<a name="l00185"></a><a class="code" href="classtcpipsend.html#74eef3cac20643e7345672c8a9117fb1">00185</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#74eef3cac20643e7345672c8a9117fb1">rtt_real_max</a>;
<a name="l00186"></a>00186   
<a name="l00187"></a><a class="code" href="classtcpipsend.html#7f55d00918c22312cc4cfa6eb61aa2d8">00187</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#7f55d00918c22312cc4cfa6eb61aa2d8">rto_min</a>;                <span class="comment">// minimum rto</span>
<a name="l00188"></a><a class="code" href="classtcpipsend.html#2897a206f366b74d838294f58929aa3a">00188</a>   <a class="code" href="defs_8h.html#b505b3bd21e0d5447484a2553096f8f2">tim_typ</a>       <a class="code" href="classtcpipsend.html#2897a206f366b74d838294f58929aa3a">rto_max</a>;                <span class="comment">// maximum rto</span>
<a name="l00189"></a>00189   
<a name="l00190"></a><a class="code" href="classtcpipsend.html#952c4ba6e9006644c04af82a9230c832">00190</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#952c4ba6e9006644c04af82a9230c832">connID</a>;                 <span class="comment">// ID of layer 4 connection</span>
<a name="l00191"></a><a class="code" href="classtcpipsend.html#24978e6dd110069dce5505ae448f5c41">00191</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#24978e6dd110069dce5505ae448f5c41">connIdInitialized</a>;      <span class="comment">// TRUE: connID initialized</span>
<a name="l00192"></a>00192   
<a name="l00193"></a><a class="code" href="classtcpipsend.html#61ce27307108d26ce3abe628fb9ac7da">00193</a>   <span class="keywordtype">unsigned</span>      <a class="code" href="classtcpipsend.html#61ce27307108d26ce3abe628fb9ac7da">segsReallyRetransmitted</a>;
<a name="l00194"></a><a class="code" href="classtcpipsend.html#fdac021a941f1fb8569b75189cc642c1">00194</a>   <span class="keywordtype">unsigned</span>      <a class="code" href="classtcpipsend.html#fdac021a941f1fb8569b75189cc642c1">maxByteReallySent</a>;
<a name="l00195"></a>00195   
<a name="l00196"></a>00196   
<a name="l00197"></a><a class="code" href="tcpipsend_8h.html#9851c7ff84c32343bd23937cecf6231d">00197</a> <span class="preprocessor">#define PROCQTHRESH     (1)</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span><span class="preprocessor">#ifdef  PROCQTHRESH</span>
<a name="l00199"></a><a class="code" href="classtcpipsend.html#f0515442614aa37eba032729838d4f7e">00199</a> <span class="preprocessor"></span>  <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#f0515442614aa37eba032729838d4f7e">calcSendStopped</a>;        <span class="comment">// TRUE: we have stopped enqueuing into</span>
<a name="l00200"></a>00200   <span class="comment">// processing queue</span>
<a name="l00201"></a><a class="code" href="classtcpipsend.html#9b4eaf126048e700fd03beee4380a096">00201</a>   <span class="keywordtype">int</span>   <a class="code" href="classtcpipsend.html#9b4eaf126048e700fd03beee4380a096">procqThresh</a>;            <span class="comment">// when to begin to do this</span>
<a name="l00202"></a>00202 <span class="preprocessor">#endif</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span>
<a name="l00204"></a><a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24b53ee35b59da13490a2b0e10d351fe3aa">00204</a>   <span class="keyword">enum</span>  {<a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24bb209990a1239cd1e6d101cc2523f4817">keyProcq</a> = 1, <a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24b57e7e4a1a824f9ec154b0838e15eaedf">keyRTO</a> = 2, <a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24be91b9f8018a322975f52857c6557790e">keyPersist</a> = 3, <a class="code" href="classtcpipsend.html#701c9a24732cbff3e85c5ef389ebd24b53ee35b59da13490a2b0e10d351fe3aa">keySlowtimo</a> = 4};
<a name="l00205"></a>00205   
<a name="l00206"></a>00206 };
<a name="l00207"></a>00207 <span class="comment">//tolua_end</span>
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 <span class="preprocessor">#endif  // TCPIPSEND_H_</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Jul 11 23:30:53 2009 for Luayats by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
